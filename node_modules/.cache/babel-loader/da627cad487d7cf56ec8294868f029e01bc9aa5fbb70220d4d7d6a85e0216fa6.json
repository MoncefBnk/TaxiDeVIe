{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Clement/Desktop/ProjetS4/taxi-de-vie/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/Clement/Desktop/ProjetS4/taxi-de-vie/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { createStore } from 'vuex';\nimport router from '@/router';\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from '@firebase/auth';\nimport { auth } from '@/firebase';\nexport default createStore({\n  state: {\n    user: null\n  },\n  getters: {},\n  mutations: {\n    SET_USER: function SET_USER(state, user) {\n      state.user = user;\n    },\n    CLEAR_USER: function CLEAR_USER(state) {\n      state.user = null;\n    }\n  },\n  actions: {\n    login: function login(_ref, details) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var commit, email, password;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit;\n              email = details.email, password = details.password;\n              _context.prev = 2;\n              _context.next = 5;\n              return signInWithEmailAndPassword(auth, email, password);\n            case 5:\n              _context.next = 18;\n              break;\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](2);\n              _context.t1 = _context.t0.code;\n              _context.next = _context.t1 === 'auth/user-not-found' ? 12 : _context.t1 === 'auth/wrong-password' ? 14 : 16;\n              break;\n            case 12:\n              alert(\"User not found\");\n              return _context.abrupt(\"break\", 17);\n            case 14:\n              alert(\"Wrong Password\");\n              return _context.abrupt(\"break\", 17);\n            case 16:\n              alert(\"Somthing went wrong\");\n            case 17:\n              return _context.abrupt(\"return\");\n            case 18:\n              commit('SET_USER', auth.currentUser);\n              router.push('/');\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[2, 7]]);\n      }))();\n    },\n    register: function register(_ref2, details) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var commit, email, password;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              commit = _ref2.commit;\n              email = details.email, password = details.password;\n              _context2.prev = 2;\n              _context2.next = 5;\n              return createUserWithEmailAndPassword(auth, email, password);\n            case 5:\n              _context2.next = 20;\n              break;\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](2);\n              _context2.t1 = _context2.t0.code;\n              _context2.next = _context2.t1 === 'auth/email-already-in-use' ? 12 : _context2.t1 === 'auth/invalid-email' ? 14 : _context2.t1 === 'auth/weak-password' ? 16 : 18;\n              break;\n            case 12:\n              alert(\"Email already in use\");\n              return _context2.abrupt(\"break\", 19);\n            case 14:\n              alert(\"Invalid email\");\n              return _context2.abrupt(\"break\", 19);\n            case 16:\n              alert(\"Weak Password\");\n              return _context2.abrupt(\"break\", 19);\n            case 18:\n              alert(\"Somthing went wrong\");\n            case 19:\n              return _context2.abrupt(\"return\");\n            case 20:\n              commit('SET_USER', auth.currentUser);\n              router.push('/');\n            case 22:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[2, 7]]);\n      }))();\n    },\n    logout: function logout(_ref3) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var commit;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              commit = _ref3.commit;\n              _context3.next = 3;\n              return signOut(auth);\n            case 3:\n              commit('CLEAR_USER');\n              router.push('/login');\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }))();\n    },\n    fetchUser: function fetchUser(_ref4) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var commit;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              commit = _ref4.commit;\n              auth.onAuthStateChanged( /*#__PURE__*/function () {\n                var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(user) {\n                  return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n                    while (1) switch (_context4.prev = _context4.next) {\n                      case 0:\n                        if (user === null) {\n                          commit('CLEAR_USER');\n                          // Redirect to login if the user is not authenticated\n                          router.push('/login');\n                        } else {\n                          commit('SET_USER', user);\n\n                          // Use router.isReady() directly to avoid accessing router.current.value\n                          if (router.isReady() && router.currentRoute.value.path === '/login') {\n                            router.push('/');\n                          }\n                        }\n                      case 1:\n                      case \"end\":\n                        return _context4.stop();\n                    }\n                  }, _callee4);\n                }));\n                return function (_x) {\n                  return _ref5.apply(this, arguments);\n                };\n              }());\n            case 2:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5);\n      }))();\n    }\n  }\n});","map":{"version":3,"names":["createStore","router","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","auth","state","user","getters","mutations","SET_USER","CLEAR_USER","actions","login","_ref","details","_asyncToGenerator","_regeneratorRuntime","mark","_callee","commit","email","password","wrap","_callee$","_context","prev","next","t0","t1","code","alert","abrupt","currentUser","push","stop","register","_ref2","_callee2","_callee2$","_context2","logout","_ref3","_callee3","_callee3$","_context3","fetchUser","_ref4","_callee5","_callee5$","_context5","onAuthStateChanged","_ref5","_callee4","_callee4$","_context4","isReady","currentRoute","value","path","_x","apply","arguments"],"sources":["C:/Users/Clement/Desktop/ProjetS4/taxi-de-vie/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\r\nimport router from '@/router'\r\nimport { \r\n  createUserWithEmailAndPassword, \r\n  signInWithEmailAndPassword, \r\n  signOut } from '@firebase/auth';\r\nimport { auth } from '@/firebase';\r\n\r\n\r\nexport default createStore({\r\n  state: {\r\n    user: null\r\n  },\r\n  getters: {\r\n  },\r\n  mutations: {\r\n    SET_USER (state, user){\r\n      state.user = user\r\n    },\r\n\r\n    CLEAR_USER (state){\r\n      state.user = null\r\n\r\n    }\r\n  },\r\n  actions: {\r\n    async login({commit}, details){\r\n      const {email, password} = details\r\n      try{\r\n        await signInWithEmailAndPassword(auth,email,password)\r\n      } catch (error) {\r\n        switch(error.code){\r\n          case 'auth/user-not-found' : \r\n            alert(\"User not found\")\r\n            break\r\n          case 'auth/wrong-password' : \r\n            alert(\"Wrong Password\")\r\n            break\r\n          default: \r\n            alert(\"Somthing went wrong\")\r\n        }\r\n\r\n        return \r\n      }\r\n      commit('SET_USER', auth.currentUser)\r\n      router.push('/')\r\n    },\r\n\r\n    async register({commit}, details){\r\n      const {email, password} = details\r\n      try{\r\n        await createUserWithEmailAndPassword(auth,email,password)\r\n      } catch (error) {\r\n        switch(error.code){\r\n          case 'auth/email-already-in-use' : \r\n            alert(\"Email already in use\")\r\n            break\r\n          case 'auth/invalid-email' : \r\n            alert(\"Invalid email\")\r\n            break\r\n          case 'auth/weak-password' :\r\n            alert(\"Weak Password\")\r\n            break\r\n          default: \r\n            alert(\"Somthing went wrong\")\r\n        }\r\n\r\n        return \r\n      }\r\n      commit('SET_USER', auth.currentUser)\r\n      router.push('/')\r\n    },\r\n\r\n    async logout({commit}){\r\n      await signOut(auth)\r\n\r\n      commit('CLEAR_USER')\r\n\r\n      router.push('/login')\r\n    },\r\n    async fetchUser({ commit }) {\r\n      auth.onAuthStateChanged(async user => {\r\n        if (user === null) {\r\n          commit('CLEAR_USER');\r\n          // Redirect to login if the user is not authenticated\r\n          router.push('/login');\r\n        } else {\r\n          commit('SET_USER', user);\r\n  \r\n          // Use router.isReady() directly to avoid accessing router.current.value\r\n          if (router.isReady() && router.currentRoute.value.path === '/login') {\r\n            router.push('/');\r\n          }\r\n        }\r\n      });\r\n    },\r\n    \r\n  }\r\n\r\n})\r\n"],"mappings":";;;AAAA,SAASA,WAAW,QAAQ,MAAM;AAClC,OAAOC,MAAM,MAAM,UAAU;AAC7B,SACEC,8BAA8B,EAC9BC,0BAA0B,EAC1BC,OAAO,QAAQ,gBAAgB;AACjC,SAASC,IAAI,QAAQ,YAAY;AAGjC,eAAeL,WAAW,CAAC;EACzBM,KAAK,EAAE;IACLC,IAAI,EAAE;EACR,CAAC;EACDC,OAAO,EAAE,CACT,CAAC;EACDC,SAAS,EAAE;IACTC,QAAQ,WAAAA,SAAEJ,KAAK,EAAEC,IAAI,EAAC;MACpBD,KAAK,CAACC,IAAI,GAAGA,IAAI;IACnB,CAAC;IAEDI,UAAU,WAAAA,WAAEL,KAAK,EAAC;MAChBA,KAAK,CAACC,IAAI,GAAG,IAAI;IAEnB;EACF,CAAC;EACDK,OAAO,EAAE;IACDC,KAAK,WAAAA,MAAAC,IAAA,EAAWC,OAAO,EAAC;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,MAAA,EAAAC,KAAA,EAAAC,QAAA;QAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAjBP,MAAM,GAAAN,IAAA,CAANM,MAAM;cACVC,KAAK,GAAcN,OAAO,CAA1BM,KAAK,EAAEC,QAAQ,GAAIP,OAAO,CAAnBO,QAAQ;cAAAG,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAEdxB,0BAA0B,CAACE,IAAI,EAACgB,KAAK,EAACC,QAAQ,CAAC;YAAA;cAAAG,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAG,EAAA,GAAAH,QAAA;cAAAA,QAAA,CAAAI,EAAA,GAE9CJ,QAAA,CAAAG,EAAA,CAAME,IAAI;cAAAL,QAAA,CAAAE,IAAA,GAAAF,QAAA,CAAAI,EAAA,KACV,qBAAqB,QAAAJ,QAAA,CAAAI,EAAA,KAGrB,qBAAqB;cAAA;YAAA;cAFxBE,KAAK,CAAC,gBAAgB,CAAC;cAAA,OAAAN,QAAA,CAAAO,MAAA;YAAA;cAGvBD,KAAK,CAAC,gBAAgB,CAAC;cAAA,OAAAN,QAAA,CAAAO,MAAA;YAAA;cAGvBD,KAAK,CAAC,qBAAqB,CAAC;YAAA;cAAA,OAAAN,QAAA,CAAAO,MAAA;YAAA;cAKlCZ,MAAM,CAAC,UAAU,EAAEf,IAAI,CAAC4B,WAAW,CAAC;cACpChC,MAAM,CAACiC,IAAI,CAAC,GAAG,CAAC;YAAA;YAAA;cAAA,OAAAT,QAAA,CAAAU,IAAA;UAAA;QAAA,GAAAhB,OAAA;MAAA;IAClB,CAAC;IAEKiB,QAAQ,WAAAA,SAAAC,KAAA,EAAWtB,OAAO,EAAC;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAoB,SAAA;QAAA,IAAAlB,MAAA,EAAAC,KAAA,EAAAC,QAAA;QAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAgB,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAd,IAAA,GAAAc,SAAA,CAAAb,IAAA;YAAA;cAAjBP,MAAM,GAAAiB,KAAA,CAANjB,MAAM;cACbC,KAAK,GAAcN,OAAO,CAA1BM,KAAK,EAAEC,QAAQ,GAAIP,OAAO,CAAnBO,QAAQ;cAAAkB,SAAA,CAAAd,IAAA;cAAAc,SAAA,CAAAb,IAAA;cAAA,OAEdzB,8BAA8B,CAACG,IAAI,EAACgB,KAAK,EAACC,QAAQ,CAAC;YAAA;cAAAkB,SAAA,CAAAb,IAAA;cAAA;YAAA;cAAAa,SAAA,CAAAd,IAAA;cAAAc,SAAA,CAAAZ,EAAA,GAAAY,SAAA;cAAAA,SAAA,CAAAX,EAAA,GAElDW,SAAA,CAAAZ,EAAA,CAAME,IAAI;cAAAU,SAAA,CAAAb,IAAA,GAAAa,SAAA,CAAAX,EAAA,KACV,2BAA2B,QAAAW,SAAA,CAAAX,EAAA,KAG3B,oBAAoB,QAAAW,SAAA,CAAAX,EAAA,KAGpB,oBAAoB;cAAA;YAAA;cALvBE,KAAK,CAAC,sBAAsB,CAAC;cAAA,OAAAS,SAAA,CAAAR,MAAA;YAAA;cAG7BD,KAAK,CAAC,eAAe,CAAC;cAAA,OAAAS,SAAA,CAAAR,MAAA;YAAA;cAGtBD,KAAK,CAAC,eAAe,CAAC;cAAA,OAAAS,SAAA,CAAAR,MAAA;YAAA;cAGtBD,KAAK,CAAC,qBAAqB,CAAC;YAAA;cAAA,OAAAS,SAAA,CAAAR,MAAA;YAAA;cAKlCZ,MAAM,CAAC,UAAU,EAAEf,IAAI,CAAC4B,WAAW,CAAC;cACpChC,MAAM,CAACiC,IAAI,CAAC,GAAG,CAAC;YAAA;YAAA;cAAA,OAAAM,SAAA,CAAAL,IAAA;UAAA;QAAA,GAAAG,QAAA;MAAA;IAClB,CAAC;IAEKG,MAAM,WAAAA,OAAAC,KAAA,EAAU;MAAA,OAAA1B,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAyB,SAAA;QAAA,IAAAvB,MAAA;QAAA,OAAAH,mBAAA,GAAAM,IAAA,UAAAqB,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAnB,IAAA,GAAAmB,SAAA,CAAAlB,IAAA;YAAA;cAARP,MAAM,GAAAsB,KAAA,CAANtB,MAAM;cAAAyB,SAAA,CAAAlB,IAAA;cAAA,OACZvB,OAAO,CAACC,IAAI,CAAC;YAAA;cAEnBe,MAAM,CAAC,YAAY,CAAC;cAEpBnB,MAAM,CAACiC,IAAI,CAAC,QAAQ,CAAC;YAAA;YAAA;cAAA,OAAAW,SAAA,CAAAV,IAAA;UAAA;QAAA,GAAAQ,QAAA;MAAA;IACvB,CAAC;IACKG,SAAS,WAAAA,UAAAC,KAAA,EAAa;MAAA,OAAA/B,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAA8B,SAAA;QAAA,IAAA5B,MAAA;QAAA,OAAAH,mBAAA,GAAAM,IAAA,UAAA0B,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAxB,IAAA,GAAAwB,SAAA,CAAAvB,IAAA;YAAA;cAAVP,MAAM,GAAA2B,KAAA,CAAN3B,MAAM;cACtBf,IAAI,CAAC8C,kBAAkB;gBAAA,IAAAC,KAAA,GAAApC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAmC,SAAM9C,IAAI;kBAAA,OAAAU,mBAAA,GAAAM,IAAA,UAAA+B,UAAAC,SAAA;oBAAA,kBAAAA,SAAA,CAAA7B,IAAA,GAAA6B,SAAA,CAAA5B,IAAA;sBAAA;wBAChC,IAAIpB,IAAI,KAAK,IAAI,EAAE;0BACjBa,MAAM,CAAC,YAAY,CAAC;0BACpB;0BACAnB,MAAM,CAACiC,IAAI,CAAC,QAAQ,CAAC;wBACvB,CAAC,MAAM;0BACLd,MAAM,CAAC,UAAU,EAAEb,IAAI,CAAC;;0BAExB;0BACA,IAAIN,MAAM,CAACuD,OAAO,CAAC,CAAC,IAAIvD,MAAM,CAACwD,YAAY,CAACC,KAAK,CAACC,IAAI,KAAK,QAAQ,EAAE;4BACnE1D,MAAM,CAACiC,IAAI,CAAC,GAAG,CAAC;0BAClB;wBACF;sBAAC;sBAAA;wBAAA,OAAAqB,SAAA,CAAApB,IAAA;oBAAA;kBAAA,GAAAkB,QAAA;gBAAA,CACF;gBAAA,iBAAAO,EAAA;kBAAA,OAAAR,KAAA,CAAAS,KAAA,OAAAC,SAAA;gBAAA;cAAA,IAAC;YAAC;YAAA;cAAA,OAAAZ,SAAA,CAAAf,IAAA;UAAA;QAAA,GAAAa,QAAA;MAAA;IACL;EAEF;AAEF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}