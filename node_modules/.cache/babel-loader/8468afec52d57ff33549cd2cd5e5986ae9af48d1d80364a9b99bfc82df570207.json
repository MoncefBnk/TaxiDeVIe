{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Clement/Desktop/ProjetS4/taxi-de-vie/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/Clement/Desktop/ProjetS4/taxi-de-vie/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.some.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\n// src/store/index.js\nimport { createStore } from 'vuex';\nimport router from '@/router';\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from 'firebase/auth';\nimport { auth } from '@/firebase';\nexport default createStore({\n  state: {\n    user: null\n  },\n  mutations: {\n    SET_USER: function SET_USER(state, user) {\n      state.user = user;\n    },\n    CLEAR_USER: function CLEAR_USER(state) {\n      state.user = null;\n    }\n  },\n  actions: {\n    login: function login(_ref, _ref2) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var commit, email, password;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit;\n              email = _ref2.email, password = _ref2.password;\n              _context.prev = 2;\n              _context.next = 5;\n              return signInWithEmailAndPassword(auth, email, password);\n            case 5:\n              commit('SET_USER', auth.currentUser);\n              console.log('Login successful');\n              router.push('/');\n              _context.next = 13;\n              break;\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](2);\n              handleAuthError(_context.t0);\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[2, 10]]);\n      }))();\n    },\n    register: function register(_ref3, _ref4) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var commit, email, password;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              commit = _ref3.commit;\n              email = _ref4.email, password = _ref4.password;\n              _context2.prev = 2;\n              _context2.next = 5;\n              return createUserWithEmailAndPassword(auth, email, password);\n            case 5:\n              commit('SET_USER', auth.currentUser);\n              router.push('/');\n              _context2.next = 12;\n              break;\n            case 9:\n              _context2.prev = 9;\n              _context2.t0 = _context2[\"catch\"](2);\n              handleAuthError(_context2.t0);\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[2, 9]]);\n      }))();\n    },\n    logout: function logout(_ref5) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var commit;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              commit = _ref5.commit;\n              _context3.next = 3;\n              return signOut(auth);\n            case 3:\n              commit('CLEAR_USER');\n              router.push('/login');\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }))();\n    },\n    fetchUser: function fetchUser(_ref6, to) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var commit;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              commit = _ref6.commit;\n              auth.onAuthStateChanged( /*#__PURE__*/function () {\n                var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(user) {\n                  return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n                    while (1) switch (_context4.prev = _context4.next) {\n                      case 0:\n                        if (!(user === null)) {\n                          _context4.next = 5;\n                          break;\n                        }\n                        commit('CLEAR_USER');\n                        if (to && to.matched && to.matched.some(function (record) {\n                          return record.meta.requiresAuth;\n                        })) {\n                          router.push('/login');\n                        }\n                        _context4.next = 9;\n                        break;\n                      case 5:\n                        commit('SET_USER', user);\n\n                        // Check if the user is authenticated and navigate to the dashboard\n                        if (!(to && to.name === 'Login')) {\n                          _context4.next = 9;\n                          break;\n                        }\n                        _context4.next = 9;\n                        return router.push({\n                          name: 'Dashboard'\n                        });\n                      case 9:\n                      case \"end\":\n                        return _context4.stop();\n                    }\n                  }, _callee4);\n                }));\n                return function (_x) {\n                  return _ref7.apply(this, arguments);\n                };\n              }());\n            case 2:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5);\n      }))();\n    }\n  }\n});\nfunction handleAuthError(error) {\n  switch (error.code) {\n    case 'auth/user-not-found':\n      alert('User not found');\n      break;\n    case 'auth/wrong-password':\n      alert('Wrong Password');\n      break;\n    case 'auth/email-already-in-use':\n      alert('Email already in use');\n      break;\n    case 'auth/invalid-email':\n      alert('Invalid email');\n      break;\n    case 'auth/weak-password':\n      alert('Weak Password');\n      break;\n    default:\n      alert('Something went wrong');\n  }\n}","map":{"version":3,"names":["createStore","router","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","auth","state","user","mutations","SET_USER","CLEAR_USER","actions","login","_ref","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","commit","email","password","wrap","_callee$","_context","prev","next","currentUser","console","log","push","t0","handleAuthError","stop","register","_ref3","_ref4","_callee2","_callee2$","_context2","logout","_ref5","_callee3","_callee3$","_context3","fetchUser","_ref6","to","_callee5","_callee5$","_context5","onAuthStateChanged","_ref7","_callee4","_callee4$","_context4","matched","some","record","meta","requiresAuth","name","_x","apply","arguments","error","code","alert"],"sources":["C:/Users/Clement/Desktop/ProjetS4/taxi-de-vie/src/store/index.js"],"sourcesContent":["// src/store/index.js\r\nimport { createStore } from 'vuex';\r\nimport router from '@/router';\r\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from 'firebase/auth';\r\nimport { auth } from '@/firebase';\r\n\r\nexport default createStore({\r\n  state: {\r\n    user: null\r\n  },\r\n  mutations: {\r\n    SET_USER(state, user) {\r\n      state.user = user;\r\n    },\r\n\r\n    CLEAR_USER(state) {\r\n      state.user = null;\r\n    }\r\n  },\r\n  actions: {\r\n    async login({ commit }, { email, password }) {\r\n      try {\r\n        await signInWithEmailAndPassword(auth, email, password);\r\n        commit('SET_USER', auth.currentUser);\r\n        console.log('Login successful');\r\n        router.push('/');\r\n      } catch (error) {\r\n        handleAuthError(error);\r\n      }\r\n    },\r\n    \r\n\r\n    async register({ commit }, { email, password }) {\r\n      try {\r\n        await createUserWithEmailAndPassword(auth, email, password);\r\n        commit('SET_USER', auth.currentUser);\r\n        router.push('/');\r\n      } catch (error) {\r\n        handleAuthError(error);\r\n      }\r\n    },\r\n\r\n    async logout({ commit }) {\r\n      await signOut(auth);\r\n      commit('CLEAR_USER');\r\n      router.push('/login');\r\n    },\r\n\r\n    async fetchUser({ commit }, to) {\r\n      auth.onAuthStateChanged(async (user) => {\r\n        if (user === null) {\r\n          commit('CLEAR_USER');\r\n          if (to && to.matched && to.matched.some((record) => record.meta.requiresAuth)) {\r\n            router.push('/login');\r\n          }\r\n        } else {\r\n          commit('SET_USER', user);\r\n    \r\n          // Check if the user is authenticated and navigate to the dashboard\r\n          if (to && to.name === 'Login') {\r\n            await router.push({ name: 'Dashboard' }); // Use the name of the route instead of the path\r\n          }\r\n        }\r\n      });\r\n    }   \r\n  }\r\n});\r\n\r\nfunction handleAuthError(error) {\r\n  switch (error.code) {\r\n    case 'auth/user-not-found':\r\n      alert('User not found');\r\n      break;\r\n    case 'auth/wrong-password':\r\n      alert('Wrong Password');\r\n      break;\r\n    case 'auth/email-already-in-use':\r\n      alert('Email already in use');\r\n      break;\r\n    case 'auth/invalid-email':\r\n      alert('Invalid email');\r\n      break;\r\n    case 'auth/weak-password':\r\n      alert('Weak Password');\r\n      break;\r\n    default:\r\n      alert('Something went wrong');\r\n  }\r\n}\r\n"],"mappings":";;;;;;AAAA;AACA,SAASA,WAAW,QAAQ,MAAM;AAClC,OAAOC,MAAM,MAAM,UAAU;AAC7B,SAASC,8BAA8B,EAAEC,0BAA0B,EAAEC,OAAO,QAAQ,eAAe;AACnG,SAASC,IAAI,QAAQ,YAAY;AAEjC,eAAeL,WAAW,CAAC;EACzBM,KAAK,EAAE;IACLC,IAAI,EAAE;EACR,CAAC;EACDC,SAAS,EAAE;IACTC,QAAQ,WAAAA,SAACH,KAAK,EAAEC,IAAI,EAAE;MACpBD,KAAK,CAACC,IAAI,GAAGA,IAAI;IACnB,CAAC;IAEDG,UAAU,WAAAA,WAACJ,KAAK,EAAE;MAChBA,KAAK,CAACC,IAAI,GAAG,IAAI;IACnB;EACF,CAAC;EACDI,OAAO,EAAE;IACDC,KAAK,WAAAA,MAAAC,IAAA,EAAAC,KAAA,EAAkC;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,MAAA,EAAAC,KAAA,EAAAC,QAAA;QAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAA/BP,MAAM,GAAAN,IAAA,CAANM,MAAM;cAAMC,KAAK,GAAAN,KAAA,CAALM,KAAK,EAAEC,QAAQ,GAAAP,KAAA,CAARO,QAAQ;cAAAG,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAE/BvB,0BAA0B,CAACE,IAAI,EAAEe,KAAK,EAAEC,QAAQ,CAAC;YAAA;cACvDF,MAAM,CAAC,UAAU,EAAEd,IAAI,CAACsB,WAAW,CAAC;cACpCC,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;cAC/B5B,MAAM,CAAC6B,IAAI,CAAC,GAAG,CAAC;cAACN,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAO,EAAA,GAAAP,QAAA;cAEjBQ,eAAe,CAAAR,QAAA,CAAAO,EAAM,CAAC;YAAC;YAAA;cAAA,OAAAP,QAAA,CAAAS,IAAA;UAAA;QAAA,GAAAf,OAAA;MAAA;IAE3B,CAAC;IAGKgB,QAAQ,WAAAA,SAAAC,KAAA,EAAAC,KAAA,EAAkC;MAAA,OAAArB,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAoB,SAAA;QAAA,IAAAlB,MAAA,EAAAC,KAAA,EAAAC,QAAA;QAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAgB,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAd,IAAA,GAAAc,SAAA,CAAAb,IAAA;YAAA;cAA/BP,MAAM,GAAAgB,KAAA,CAANhB,MAAM;cAAMC,KAAK,GAAAgB,KAAA,CAALhB,KAAK,EAAEC,QAAQ,GAAAe,KAAA,CAARf,QAAQ;cAAAkB,SAAA,CAAAd,IAAA;cAAAc,SAAA,CAAAb,IAAA;cAAA,OAElCxB,8BAA8B,CAACG,IAAI,EAAEe,KAAK,EAAEC,QAAQ,CAAC;YAAA;cAC3DF,MAAM,CAAC,UAAU,EAAEd,IAAI,CAACsB,WAAW,CAAC;cACpC1B,MAAM,CAAC6B,IAAI,CAAC,GAAG,CAAC;cAACS,SAAA,CAAAb,IAAA;cAAA;YAAA;cAAAa,SAAA,CAAAd,IAAA;cAAAc,SAAA,CAAAR,EAAA,GAAAQ,SAAA;cAEjBP,eAAe,CAAAO,SAAA,CAAAR,EAAM,CAAC;YAAC;YAAA;cAAA,OAAAQ,SAAA,CAAAN,IAAA;UAAA;QAAA,GAAAI,QAAA;MAAA;IAE3B,CAAC;IAEKG,MAAM,WAAAA,OAAAC,KAAA,EAAa;MAAA,OAAA1B,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAyB,SAAA;QAAA,IAAAvB,MAAA;QAAA,OAAAH,mBAAA,GAAAM,IAAA,UAAAqB,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAnB,IAAA,GAAAmB,SAAA,CAAAlB,IAAA;YAAA;cAAVP,MAAM,GAAAsB,KAAA,CAANtB,MAAM;cAAAyB,SAAA,CAAAlB,IAAA;cAAA,OACbtB,OAAO,CAACC,IAAI,CAAC;YAAA;cACnBc,MAAM,CAAC,YAAY,CAAC;cACpBlB,MAAM,CAAC6B,IAAI,CAAC,QAAQ,CAAC;YAAC;YAAA;cAAA,OAAAc,SAAA,CAAAX,IAAA;UAAA;QAAA,GAAAS,QAAA;MAAA;IACxB,CAAC;IAEKG,SAAS,WAAAA,UAAAC,KAAA,EAAaC,EAAE,EAAE;MAAA,OAAAhC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAA+B,SAAA;QAAA,IAAA7B,MAAA;QAAA,OAAAH,mBAAA,GAAAM,IAAA,UAAA2B,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAzB,IAAA,GAAAyB,SAAA,CAAAxB,IAAA;YAAA;cAAdP,MAAM,GAAA2B,KAAA,CAAN3B,MAAM;cACtBd,IAAI,CAAC8C,kBAAkB;gBAAA,IAAAC,KAAA,GAAArC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAoC,SAAO9C,IAAI;kBAAA,OAAAS,mBAAA,GAAAM,IAAA,UAAAgC,UAAAC,SAAA;oBAAA,kBAAAA,SAAA,CAAA9B,IAAA,GAAA8B,SAAA,CAAA7B,IAAA;sBAAA;wBAAA,MAC7BnB,IAAI,KAAK,IAAI;0BAAAgD,SAAA,CAAA7B,IAAA;0BAAA;wBAAA;wBACfP,MAAM,CAAC,YAAY,CAAC;wBACpB,IAAI4B,EAAE,IAAIA,EAAE,CAACS,OAAO,IAAIT,EAAE,CAACS,OAAO,CAACC,IAAI,CAAC,UAACC,MAAM;0BAAA,OAAKA,MAAM,CAACC,IAAI,CAACC,YAAY;wBAAA,EAAC,EAAE;0BAC7E3D,MAAM,CAAC6B,IAAI,CAAC,QAAQ,CAAC;wBACvB;wBAACyB,SAAA,CAAA7B,IAAA;wBAAA;sBAAA;wBAEDP,MAAM,CAAC,UAAU,EAAEZ,IAAI,CAAC;;wBAExB;wBAAA,MACIwC,EAAE,IAAIA,EAAE,CAACc,IAAI,KAAK,OAAO;0BAAAN,SAAA,CAAA7B,IAAA;0BAAA;wBAAA;wBAAA6B,SAAA,CAAA7B,IAAA;wBAAA,OACrBzB,MAAM,CAAC6B,IAAI,CAAC;0BAAE+B,IAAI,EAAE;wBAAY,CAAC,CAAC;sBAAA;sBAAA;wBAAA,OAAAN,SAAA,CAAAtB,IAAA;oBAAA;kBAAA,GAAAoB,QAAA;gBAAA,CAG7C;gBAAA,iBAAAS,EAAA;kBAAA,OAAAV,KAAA,CAAAW,KAAA,OAAAC,SAAA;gBAAA;cAAA,IAAC;YAAC;YAAA;cAAA,OAAAd,SAAA,CAAAjB,IAAA;UAAA;QAAA,GAAAe,QAAA;MAAA;IACL;EACF;AACF,CAAC,CAAC;AAEF,SAAShB,eAAeA,CAACiC,KAAK,EAAE;EAC9B,QAAQA,KAAK,CAACC,IAAI;IAChB,KAAK,qBAAqB;MACxBC,KAAK,CAAC,gBAAgB,CAAC;MACvB;IACF,KAAK,qBAAqB;MACxBA,KAAK,CAAC,gBAAgB,CAAC;MACvB;IACF,KAAK,2BAA2B;MAC9BA,KAAK,CAAC,sBAAsB,CAAC;MAC7B;IACF,KAAK,oBAAoB;MACvBA,KAAK,CAAC,eAAe,CAAC;MACtB;IACF,KAAK,oBAAoB;MACvBA,KAAK,CAAC,eAAe,CAAC;MACtB;IACF;MACEA,KAAK,CAAC,sBAAsB,CAAC;EACjC;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}